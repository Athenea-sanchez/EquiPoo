//wachen, este codigo junta las 3 colecciones y pegunta cual quieres ocupar, y cada coleccion tiene su funcion especifica
//nomas seria probarlo hasta que truene alvvv, y ya arreglar esos detalles

import java.util.*;

// ==========================
// M√ìDULO CONJUNTOS - CAT√ÅLOGO DE LIBROS
// ==========================
class BibliotecaConjuntos {
    private Set<String> catalogo = new HashSet<>();
    private Scanner scanner = new Scanner(System.in);

    public void iniciar() {
        int opcion;
        do {
            System.out.println("\n===== üìö Cat√°logo de Libros (Conjuntos) =====");
            System.out.println("1. Agregar libro");
            System.out.println("2. Eliminar libro");
            System.out.println("3. Buscar libro");
            System.out.println("4. Mostrar cat√°logo");
            System.out.println("0. Volver al men√∫ principal");
            System.out.print("Selecciona una opci√≥n: ");
            opcion = scanner.nextInt();
            scanner.nextLine();

            switch (opcion) {
                case 1 -> agregarLibro();
                case 2 -> eliminarLibro();
                case 3 -> buscarLibro();
                case 4 -> mostrarCatalogo();
                case 0 -> System.out.println("üîô Volviendo al men√∫ principal...");
                default -> System.out.println("‚ö†Ô∏è Opci√≥n inv√°lida.");
            }
        } while (opcion != 0);
    }

    private void agregarLibro() {
        System.out.print("üëâ Ingresa el t√≠tulo del libro: ");
        String titulo = scanner.nextLine();
        if (catalogo.add(titulo)) {
            System.out.println("‚úÖ Libro agregado.");
        } else {
            System.out.println("‚ö†Ô∏è Ese libro ya est√° en el cat√°logo.");
        }
    }

    private void eliminarLibro() {
        System.out.print("üëâ Ingresa el t√≠tulo del libro a eliminar: ");
        String titulo = scanner.nextLine();
        if (catalogo.remove(titulo)) {
            System.out.println("‚úÖ Libro eliminado.");
        } else {
            System.out.println("‚ö†Ô∏è Ese libro no existe en el cat√°logo.");
        }
    }

    private void buscarLibro() {
        System.out.print("üëâ Ingresa el t√≠tulo a buscar: ");
        String titulo = scanner.nextLine();
        if (catalogo.contains(titulo)) {
            System.out.println("‚úÖ El libro est√° en el cat√°logo.");
        } else {
            System.out.println("‚ùå El libro no est√° en el cat√°logo.");
        }
    }

    public void mostrarCatalogo() {
        if (catalogo.isEmpty()) {
            System.out.println("üì≠ El cat√°logo est√° vac√≠o.");
        } else {
            System.out.println("\nüìö Cat√°logo de libros:");
            for (String libro : catalogo) {
                System.out.println("- " + libro);
            }
        }
    }

    // M√©todo para que el m√≥dulo Mapas pueda consultar libros
    public boolean existeLibro(String titulo) {
        return catalogo.contains(titulo);
    }
}


// ==========================
// M√ìDULO LISTAS - USUARIOS (PARA TU COMPA√ëERO)
// ==========================
class BibliotecaListas {
    private List<String> usuarios = new ArrayList<>();
    private Scanner scanner = new Scanner(System.in);

    public void iniciar() {
        int opcion;
        do {
            System.out.println("\n===== üë• Gesti√≥n de Usuarios (Listas) =====");
            System.out.println("1. Registrar usuario");
            System.out.println("2. Eliminar usuario");
            System.out.println("3. Mostrar usuarios");
            System.out.println("0. Volver al men√∫ principal");
            System.out.print("Selecciona una opci√≥n: ");
            opcion = scanner.nextInt();
            scanner.nextLine();

            switch (opcion) {
                case 1 -> registrarUsuario();
                case 2 -> eliminarUsuario();
                case 3 -> mostrarUsuarios();
                case 0 -> System.out.println("üîô Volviendo al men√∫ principal...");
                default -> System.out.println("‚ö†Ô∏è Opci√≥n inv√°lida.");
            }
        } while (opcion != 0);
    }

    private void registrarUsuario() {
        System.out.print("üëâ Ingresa el nombre del usuario: ");
        String usuario = scanner.nextLine();
        usuarios.add(usuario);
        System.out.println("‚úÖ Usuario registrado.");
    }

    private void eliminarUsuario() {
        System.out.print("üëâ Ingresa el nombre del usuario a eliminar: ");
        String usuario = scanner.nextLine();
        if (usuarios.remove(usuario)) {
            System.out.println("‚úÖ Usuario eliminado.");
        } else {
            System.out.println("‚ö†Ô∏è Usuario no encontrado.");
        }
    }

    private void mostrarUsuarios() {
        if (usuarios.isEmpty()) {
            System.out.println("üì≠ No hay usuarios registrados.");
        } else {
            System.out.println("\nüë• Usuarios registrados:");
            for (String u : usuarios) {
                System.out.println("- " + u);
            }
        }
    }

    // M√©todo para el m√≥dulo Mapas
    public boolean existeUsuario(String usuario) {
        return usuarios.contains(usuario);
    }
}


// ==========================
// M√ìDULO MAPAS - PR√âSTAMOS (PARA TU COMPA√ëERO)
// ==========================
class BibliotecaMapas {
    private Map<String, List<String>> prestamos = new HashMap<>();
    private Scanner scanner = new Scanner(System.in);
    private BibliotecaListas usuarios;
    private BibliotecaConjuntos catalogo;

    public BibliotecaMapas(BibliotecaListas usuarios, BibliotecaConjuntos catalogo) {
        this.usuarios = usuarios;
        this.catalogo = catalogo;
    }

    public void iniciar() {
        int opcion;
        do {
            System.out.println("\n===== üìñ Gesti√≥n de Pr√©stamos (Mapas) =====");
            System.out.println("1. Prestar libro a usuario");
            System.out.println("2. Devolver libro");
            System.out.println("3. Mostrar pr√©stamos");
            System.out.println("0. Volver al men√∫ principal");
            System.out.print("Selecciona una opci√≥n: ");
            opcion = scanner.nextInt();
            scanner.nextLine();

            switch (opcion) {
                case 1 -> prestarLibro();
                case 2 -> devolverLibro();
                case 3 -> mostrarPrestamos();
                case 0 -> System.out.println("üîô Volviendo al men√∫ principal...");
                default -> System.out.println("‚ö†Ô∏è Opci√≥n inv√°lida.");
            }
        } while (opcion != 0);
    }

    private void prestarLibro() {
        System.out.print("üëâ Ingresa el nombre del usuario: ");
        String usuario = scanner.nextLine();

        if (!usuarios.existeUsuario(usuario)) {
            System.out.println("‚ö†Ô∏è Usuario no registrado.");
            return;
        }

        System.out.print("üëâ Ingresa el t√≠tulo del libro: ");
        String libro = scanner.nextLine();

        if (!catalogo.existeLibro(libro)) {
            System.out.println("‚ö†Ô∏è Ese libro no est√° en el cat√°logo.");
            return;
        }

        prestamos.putIfAbsent(usuario, new ArrayList<>());
        prestamos.get(usuario).add(libro);
        System.out.println("‚úÖ Libro prestado a " + usuario);
    }

    private void devolverLibro() {
        System.out.print("üëâ Ingresa el nombre del usuario: ");
        String usuario = scanner.nextLine();

        if (!prestamos.containsKey(usuario)) {
            System.out.println("‚ö†Ô∏è Ese usuario no tiene pr√©stamos.");
            return;
        }

        System.out.print("üëâ Ingresa el t√≠tulo del libro a devolver: ");
        String libro = scanner.nextLine();

        if (prestamos.get(usuario).remove(libro)) {
            System.out.println("‚úÖ Libro devuelto.");
        } else {
            System.out.println("‚ö†Ô∏è Ese usuario no ten√≠a ese libro.");
        }
    }

    private void mostrarPrestamos() {
        if (prestamos.isEmpty()) {
            System.out.println("üì≠ No hay pr√©stamos registrados.");
        } else {
            System.out.println("\nüìñ Pr√©stamos registrados:");
            for (var entry : prestamos.entrySet()) {
                System.out.println("- Usuario: " + entry.getKey() + " ‚Üí Libros: " + entry.getValue());
            }
        }
    }
}


// ==========================
// MEN√ö PRINCIPAL
// ==========================
public class BibliotecaApp {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        BibliotecaConjuntos moduloConjuntos = new BibliotecaConjuntos();
        BibliotecaListas moduloListas = new BibliotecaListas();
        BibliotecaMapas moduloMapas = new BibliotecaMapas(moduloListas, moduloConjuntos);

        int opcion;
        do {
            System.out.println("\n===== üìö SISTEMA DE BIBLIOTECA =====");
            System.out.println("1. M√≥dulo de Cat√°logo (Conjuntos)");
            System.out.println("2. M√≥dulo de Usuarios (Listas)");
            System.out.println("3. M√≥dulo de Pr√©stamos (Mapas)");
            System.out.println("0. Salir");
            System.out.print("Selecciona una opci√≥n: ");
            opcion = scanner.nextInt();

            switch (opcion) {
                case 1 -> moduloConjuntos.iniciar();
                case 2 -> moduloListas.iniciar();
                case 3 -> moduloMapas.iniciar();
                case 0 -> System.out.println("üëã Cerrando sistema de biblioteca...");
                default -> System.out.println("‚ö†Ô∏è Opci√≥n inv√°lida.");
            }
        } while (opcion != 0);
    }
}
